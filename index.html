<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ  çŸ­ç§Ÿæ¸…æ½”ç®¡ç†</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
        
        .login-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; background: linear-gradient(135deg, #8A9A5B 0%, #6B7A45 100%); }
        .login-box { background: white; padding: 30px; border-radius: 16px; width: 100%; max-width: 350px; text-align: center; }
        .login-logo { font-size: 60px; margin-bottom: 20px; }
        .login-title { font-size: 24px; margin-bottom: 20px; color: #333; }
        .role-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #8A9A5B; border-radius: 10px; background: white; color: #8A9A5B; font-size: 16px; cursor: pointer; }
        .role-btn:hover { background: #8A9A5B; color: white; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 20px; border-radius: 12px; width: 90%; max-width: 350px; }
        .modal-content h3 { margin-bottom: 15px; color: #333; }
        .modal-content input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        .modal-content button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; background: #8A9A5B; color: white; font-size: 14px; cursor: pointer; }
        .modal-content button.cancel { background: #999; }
    </style>
</head>
<body>
    <div class="login-screen">
        <div class="login-box">
            <div class="login-logo">ğŸ </div>
            <div class="login-title">çŸ­ç§Ÿæ¸…æ½”ç®¡ç†</div>
            <button class="role-btn" onclick="showHostLogin()">ğŸ  æˆ¿æ±ï¼ˆç™¼å–®ï¼‰</button>
            <button class="role-btn" onclick="showCleanerLogin()">ğŸ‘· æ¸…æ½”å·¥ï¼ˆæ¥å–®ï¼‰</button>
            <button class="role-btn" onclick="location.href='admin.html'">ğŸ“Š èª¿åº¦å¹³å°ï¼ˆç®¡ç†ï¼‰</button>
        </div>
    </div>
    
    <!-- æˆ¿æ±ç™»éŒ„ -->
    <div class="modal" id="modal-host">
        <div class="modal-content">
            <h3>ğŸ  æˆ¿æ±ç™»éŒ„</h3>
            <input type="text" id="host-code" placeholder="é©—è­‰ç¢¼">
            <button onclick="loginHost()">ç™»éŒ„</button>
            <button class="cancel" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- æ¸…æ½”å·¥ç™»éŒ„ -->
    <div class="modal" id="modal-cleaner">
        <div class="modal-content">
            <h3>ğŸ‘· æ¸…æ½”å·¥ç™»éŒ„</h3>
            <input type="text" id="cleaner-code" placeholder="é©—è­‰ç¢¼">
            <button onclick="loginCleaner()">ç™»éŒ„</button>
            <button class="cancel" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
    
    <script>
        const API = 'http://127.0.0.1:5000/api';
        
        function showHostLogin() { document.getElementById('modal-host').classList.add('active'); }
        function showCleanerLogin() { document.getElementById('modal-cleaner').classList.add('active'); }
        function closeModal() { 
            document.getElementById('modal-host').classList.remove('active');
            document.getElementById('modal-cleaner').classList.remove('active');
        }
        
        async function loginHost() {
            const code = document.getElementById('host-code').value;
            if (!code) { alert('è«‹è¼¸å…¥é©—è­‰ç¢¼'); return; }
            
            const res = await fetch(API + '/hosts/code/' + code);
            const data = await res.json();
            
            if (res.ok && data.data) {
                localStorage.setItem('host_id', data.data.id);
                localStorage.setItem('host_phone', data.data.phone);
                location.href = 'host.html';
            } else {
                alert('é©—è­‰ç¢¼éŒ¯èª¤');
            }
        }
        
        async function loginCleaner() {
            const code = document.getElementById('cleaner-code').value;
            if (!code) { alert('è«‹è¼¸å…¥é©—è­‰ç¢¼'); return; }
            
            const res = await fetch(API + '/cleaners');
            const data = await res.json();
            const cleaner = data.data?.find(c => c.code === code);
            
            if (cleaner) {
                localStorage.setItem('cleaner_id', cleaner.id);
                localStorage.setItem('cleaner_code', cleaner.code);
                location.href = 'cleaner.html';
            } else {
                alert('é©—è­‰ç¢¼éŒ¯èª¤');
            }
        }
    </script>
</body>
</html>
