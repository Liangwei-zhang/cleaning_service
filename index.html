<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üè† Áü≠ÁßüÊ∏ÖÊΩîÁÆ°ÁêÜ</title>
    <style>
:root {
    /* Spacing */
    --space-1: 4px; --space-2: 8px; --space-3: 12px; --space-4: 16px;
    --space-6: 24px; --space-8: 32px; --space-12: 48px; --space-16: 64px;
    
    /* Radius */
    --r-sm: 8px; --r-md: 16px; --r-lg: 24px;
    
    /* Colors - Light Mode */
    --brand-primary: #6366F1;
    --brand-primary-dark: #4F46E5;
    --bg-main: #F8FAFC;
    --bg-card: #FFFFFF;
    --bg-card-active: #F1F5F9;
    --text-h: #0F172A;
    --text-p: #475569;
    --text-muted: #94A3B8;
    --border-color: #E2E8F0;
    --success: #10B981;
    --danger: #EF4444;
    --warning: #F59E0B;
    
    /* Dark Mode - Pure Black for OLED */
    @media (prefers-color-scheme: dark) {
        --bg-main: #000000;
        --bg-card: #0A0A0A;
        --bg-card-active: #1A1A1A;
        --text-h: #F8FAFC;
        --text-p: #CBD5E1;
        --text-muted: #64748B;
        --border-color: #262626;
    }
}

* {
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
}

body {
    font-family: "Inter", "SF Pro Display", "PingFang SC", system-ui, sans-serif;
    font-size: 16px;
    line-height: 1.5;
    letter-spacing: 0.01em;
    background: var(--bg-main);
    color: var(--text-p);
    margin: 0;
    padding: 0;
    min-height: 100vh;
    padding-bottom: calc(64px + env(safe-area-inset-bottom));
    -webkit-tap-highlight-color: transparent;
    touch-action: manipulation;
}

/* Typography */
h1, .h1 { font-size: 24px; font-weight: 700; line-height: 1.2; letter-spacing: -0.01em; color: var(--text-h); }
h2, .h2 { font-size: 18px; font-weight: 600; line-height: 1.3; color: var(--text-h); }
.caption { font-size: 12px; line-height: 1.4; letter-spacing: 0.02em; color: var(--text-muted); }

/* Header - Sticky with blur */
header {
    position: sticky;
    top: 0;
    z-index: 100;
    height: 56px;
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    border-bottom: 0.5px solid var(--border-color);
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 0 var(--space-4);
}
@media (prefers-color-scheme: dark) {
    header { background: rgba(0, 0, 0, 0.7); }
}

/* Navigation - Bottom Tab Bar */
.nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: calc(64px + env(safe-area-inset-bottom));
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(25px) saturate(180%);
    -webkit-backdrop-filter: blur(25px) saturate(180%);
    border-top: 0.5px solid var(--border-color);
    display: flex;
    z-index: 99;
}
@media (prefers-color-scheme: dark) {
    .nav { background: rgba(0, 0, 0, 0.7); }
}

.nav-btn {
    flex: 1;
    height: 64px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    position: relative;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
}
.nav-btn.active { color: var(--brand-primary); font-weight: 600; }
.nav-btn.active::before {
    content: '';
    position: absolute;
    top: 8px;
    width: 24px;
    height: 3px;
    background: var(--brand-primary);
    border-radius: 3px;
}

/* Content Area */
.content {
    padding: var(--space-4);
    padding-bottom: calc(64px + var(--space-16) + env(safe-area-inset-bottom));
}

/* Bento Cards */
.card {
    background: var(--bg-card);
    border-radius: var(--r-md);
    padding: var(--space-4);
    margin-bottom: var(--space-3);
    border: 1px solid transparent;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    transition: transform 0.2s cubic-bezier(0.4, 0, 1, 1), box-shadow 0.2s;
    will-change: transform;
}
.card:active {
    background: var(--bg-card-active);
    transform: scale(0.98) translateY(1px);
    box-shadow: none;
}

.card-title { font-size: 16px; font-weight: 600; color: var(--text-h); margin-bottom: var(--space-1); }
.card-info { font-size: 13px; color: var(--text-p); margin-top: var(--space-1); }
.price { color: var(--brand-primary); font-weight: 600; font-size: 18px; }

/* Buttons - Physics-based */
.btn {
    min-height: 44px;
    min-width: 44px;
    padding: var(--space-3) var(--space-6);
    border-radius: var(--r-md);
    font-weight: 600;
    font-size: 15px;
    cursor: pointer;
    border: none;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    transition: transform 0.15s cubic-bezier(0.17, 0.67, 0.12, 1.35), filter 0.15s;
    will-change: transform;
}
.btn:active {
    transform: scale(0.95);
    filter: brightness(0.9);
}

.btn-primary {
    background: var(--brand-primary);
    color: #fff;
    box-shadow: 0 4px 12px rgba(99, 102, 241, 0.25);
}
.btn-success { background: var(--success); color: #fff; box-shadow: 0 4px 12px rgba(16, 185, 129, 0.25); }
.btn-danger { background: var(--danger); color: #fff; box-shadow: 0 4px 12px rgba(239, 68, 68, 0.25); }

.card-actions { display: flex; gap: var(--space-2); justify-content: flex-end; margin-top: var(--space-3); }
.card-actions .btn { padding: var(--space-3) var(--space-4); }

/* Badges */
.badge {
    display: inline-block;
    padding: var(--space-1) var(--space-2);
    border-radius: var(--r-sm);
    font-size: 12px;
    font-weight: 500;
}
.badge.open { background: #FEF3C7; color: #D97706; }
.badge.accepted { background: #DBEAFE; color: #2563EB; }
.badge.completed { background: #D1FAE5; color: #059669; }

/* Modal */
.modal {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    padding: var(--space-4);
    backdrop-filter: blur(4px);
}
.modal.active { display: flex; }

.modal-content {
    background: var(--bg-card);
    border-radius: var(--r-lg);
    padding: var(--space-6);
    width: 100%;
    max-width: 400px;
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.2);
    animation: modalIn 0.3s cubic-bezier(0.17, 0.67, 0.12, 1.35);
}
@keyframes modalIn {
    from { opacity: 0; transform: scale(0.95) translateY(10px); }
    to { opacity: 1; transform: scale(1) translateY(0); }
}

.modal-content input, .modal-content select {
    width: 100%;
    height: 48px;
    padding: 0 var(--space-4);
    border: 1px solid var(--border-color);
    border-radius: var(--r-sm);
    font-size: 16px;
    background: var(--bg-main);
    color: var(--text-h);
    margin-bottom: var(--space-3);
    outline: none;
    -webkit-appearance: none;
}
.modal-content input:focus { border-color: var(--brand-primary); }

.modal-btns { display: flex; gap: var(--space-3); margin-top: var(--space-6); }
.modal-btns .btn { flex: 1; }

/* Toast */
.toast {
    position: fixed;
    bottom: calc(64px + var(--space-4) + env(safe-area-inset-bottom));
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: var(--text-h);
    color: var(--bg-main);
    padding: var(--space-3) var(--space-6);
    border-radius: var(--r-md);
    font-size: 14px;
    opacity: 0;
    transition: all 0.3s cubic-bezier(0.4, 0, 1, 1);
    z-index: 2000;
    will-change: transform, opacity;
}
.toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }

/* FAB */
.fab {
    position: fixed;
    bottom: calc(64px + var(--space-6) + env(safe-area-inset-bottom));
    right: var(--space-6);
    width: 56px;
    height: 56px;
    border-radius: var(--r-md);
    background: var(--brand-primary);
    color: #fff;
    border: none;
    font-size: 24px;
    box-shadow: 0 6px 20px rgba(99, 102, 241, 0.35);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 90;
    transition: transform 0.2s cubic-bezier(0.17, 0.67, 0.12, 1.35);
    will-change: transform;
}
.fab:active { transform: scale(0.92); }

/* Stats */
.stats {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: var(--space-3);
    padding: var(--space-4);
    background: var(--bg-card);
}
.stat { text-align: center; padding: var(--space-3); background: var(--bg-main); border-radius: var(--r-sm); }
.stat-num { font-size: 24px; font-weight: 700; color: var(--brand-primary); }
.stat-label { font-size: 12px; color: var(--text-muted); }

/* Confirm Dialog */
.confirm-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0, 0, 0, 0.6);
    z-index: 2000;
    align-items: center;
    justify-content: center;
    padding: var(--space-4);
    backdrop-filter: blur(4px);
}
.confirm-overlay.show { display: flex; }

.confirm-box {
    background: var(--bg-card);
    border-radius: var(--r-lg);
    padding: var(--space-6);
    width: 100%;
    max-width: 320px;
    text-align: center;
    animation: modalIn 0.25s cubic-bezier(0.17, 0.67, 0.12, 1.35);
}
.confirm-icon { font-size: 48px; margin-bottom: var(--space-3); }
.confirm-title { font-size: 18px; font-weight: 600; color: var(--text-h); margin-bottom: var(--space-2); }
.confirm-desc { font-size: 14px; color: var(--text-p); margin-bottom: var(--space-6); }
.confirm-btns { display: flex; gap: var(--space-3); }
.confirm-btn { flex: 1; height: 48px; border-radius: var(--r-md); font-weight: 600; cursor: border: none; font-size: 15px; }
.confirm-btn.cancel { background: var(--bg-main); color: var(--text-p); }
.confirm-btn.danger { background: var(--danger); color: #fff; }

/* Login Screen */
.login-screen {
    min-height: 100vh;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: var(--space-6);
    background: linear-gradient(135deg, var(--brand-primary) 0%, var(--brand-primary-dark) 100%);
}
.login-box {
    background: var(--bg-card);
    padding: var(--space-8);
    border-radius: var(--r-lg);
    width: 100%;
    max-width: 360px;
    text-align: center;
    box-shadow: 0 24px 48px rgba(0, 0, 0, 0.2);
}
.login-logo { font-size: 56px; margin-bottom: var(--space-4); }
.login-title { font-size: 22px; font-weight: 700; color: var(--text-h); margin-bottom: var(--space-6); }

.role-btn {
    width: 100%;
    height: 56px;
    margin-bottom: var(--space-3);
    border: 1px solid var(--border-color);
    border-radius: var(--r-md);
    background: var(--bg-card);
    color: var(--text-h);
    font-size: 15px;
    font-weight: 500;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    transition: all 0.2s;
}
.role-btn:active { background: var(--bg-card-active); transform: scale(0.98); }

/* Animations */
@keyframes fadeIn {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}
.card, .content { animation: fadeIn 0.3s cubic-bezier(0.4, 0, 1, 1); }

.empty { text-align: center; padding: var(--space-12); color: var(--text-muted); }
    </style>
</head>
<body>
    <div class="login-screen">
        <div class="login-box">
            <div class="login-logo">üè†</div>
            <div class="login-title">Áü≠ÁßüÊ∏ÖÊΩîÁÆ°ÁêÜ</div>
            <button class="role-btn" onclick="showHostLogin()">üè† ÊàøÊù±ÔºàÁôºÂñÆÔºâ</button>
            <button class="role-btn" onclick="showCleanerLogin()">üë∑ Ê∏ÖÊΩîÂ∑•ÔºàÊé•ÂñÆÔºâ</button>
            <button class="role-btn" onclick="showAdminLogin()">üìä Ë™øÂ∫¶Âπ≥Âè∞ÔºàÁÆ°ÁêÜÔºâ</button>
        </div>
    </div>
    
    <div class="modal" id="modal-host">
        <div class="modal-content">
            <h2>üè† ÊàøÊù±ÁôªÈåÑ</h2>
            <input type="text" id="host-code" placeholder="È©óË≠âÁ¢º" value="547047">
            <button class="btn btn-primary" onclick="loginHost()">ÁôªÈåÑ</button>
            <button class="btn" style="background:var(--bg-main);color:var(--text-p)" onclick="closeModal()">ÂèñÊ∂à</button>
        </div>
    </div>
    
    <div class="modal" id="modal-cleaner">
        <div class="modal-content">
            <h2>üë∑ Ê∏ÖÊΩîÂ∑•ÁôªÈåÑ</h2>
            <input type="text" id="cleaner-code"Á¢º" value="733025">
            placeholder="È©óË≠â <button class="btn btn-primary" onclick="loginCleaner()">ÁôªÈåÑ</button>
            <button class="btn" style="background:var(--bg-main);color:var(--text-p)" onclick="closeModal()">ÂèñÊ∂à</button>
        </div>
    </div>
    
    <div class="modal" id="modal-admin">
        <div class="modal-content">
            <h2>üìä ÁÆ°ÁêÜÂì°ÁôªÈåÑ</h2>
            <input type="text" id="admin-username" placeholder="Áî®Êà∂Âêç" value="admin">
            <input type="password" id="admin-password" placeholder="ÂØÜÁ¢º" value="admin123">
            <button class="btn btn-primary" onclick="loginAdmin()">ÁôªÈåÑ</button>
            <button class="btn" style="background:var(--bg-main);color:var(--text-p)" onclick="closeModal()">ÂèñÊ∂à</button>
        </div>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <script>
        const API = 'https://biggish-londyn-unconvolute.ngrok-free.dev/api';
        
        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.style.background = type === 'success' ? 'var(--success)' : type === 'error' ? 'var(--danger)' : 'var(--text-h)';
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => toast.classList.remove('show'), 2500);
            if (navigator.vibrate) navigator.vibrate(10);
        }
        
        function showHostLogin() { document.getElementById('modal-host').classList.add('active'); }
        function showCleanerLogin() { document.getElementById('modal-cleaner').classList.add('active'); }
        function showAdminLogin() { document.getElementById('modal-admin').classList.add('active'); }
        function closeModal() { document.querySelectorAll('.modal').forEach(m => m.classList.remove('active')); }
        
        async function loginHost() {
            const code = document.getElementById('host-code').value;
            if (!code) { showToast('Ë´ãËº∏ÂÖ•È©óË≠âÁ¢º', 'warn'); return; }
            const res = await fetch(API + '/hosts/code/' + code);
            const data = await res.json();
            if (res.ok && data.data) {
                localStorage.setItem('host_id', data.data.id);
                localStorage.setItem('host_phone', data.data.phone);
                location.href = 'host.html';
            } else { showToast('È©óË≠âÁ¢ºÈåØË™§', 'error'); }
        }
        
        async function loginCleaner() {
            const code = document.getElementById('cleaner-code').value;
            if (!code) { showToast('Ë´ãËº∏ÂÖ•È©óË≠âÁ¢º', 'warn'); return; }
            const res = await fetch(API + '/cleaners');
            const data = await res.json();
            const cleaner = data.data?.find(c => c.code === code);
            if (cleaner) {
                localStorage.setItem('cleaner_id', cleaner.id);
                localStorage.setItem('cleaner_code', cleaner.code);
                location.href = 'cleaner.html';
            } else { showToast('È©óË≠âÁ¢ºÈåØË™§', 'error'); }
        }
        
        async function loginAdmin() {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            if (username === 'admin' && password === 'admin123') {
                localStorage.setItem('admin_user', username);
                location.href = 'admin.html';
            } else { showToast('Áî®Êà∂ÂêçÊàñÂØÜÁ¢ºÈåØË™§', 'error'); }
        }
    </script>
</body>
</html>
