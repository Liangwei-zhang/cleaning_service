<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ğŸ  SmartClean | çŸ­ç§Ÿæ¸…æ½”èª¿åº¦ç³»çµ±</title>
    <style>
        /* * 2026 Flagship Design Language System
         * Core: OKLCH Color Space, Glassmorphism 2.0, Haptic-Simulated Transitions
         */
        
        @layer base {
            :root {
                /* OKLCH: ç²¾æº–æ„ŸçŸ¥äº®åº¦ã€å½©åº¦èˆ‡è‰²ç›¸ */
                --bg-canvas: oklch(98% 0.005 240);
                --primary: oklch(60% 0.18 255);
                --primary-deep: oklch(45% 0.22 260);
                --accent-orange: oklch(75% 0.15 45);
                --accent-blue: oklch(70% 0.12 220);
                --accent-purple: oklch(70% 0.12 300);
                --midnight: oklch(20% 0.01 250);
                
                /* ç»ç’ƒæ“¬æ…‹ 2.0 åƒæ•¸ */
                --glass-bg: oklch(100% 0 0 / 75%);
                --glass-border: oklch(100% 0 0 / 40%);
                --glass-shadow: oklch(0% 0 0 / 8%);
                
                /* ç‰©ç†åœ“è§’èˆ‡é–“è· */
                --radius-xl: 38px;
                --radius-lg: 28px;
                --radius-md: 18px;
                --spring-easing: cubic-bezier(0.34, 1.56, 0.64, 1);
            }

            * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
            
            body {
                margin: 0;
                font-family: 'Inter', system-ui, -apple-system, sans-serif;
                background: 
                    radial-gradient(at 0% 0%, oklch(94% 0.04 260), transparent 50%),
                    radial-gradient(at 100% 100%, oklch(92% 0.06 40), transparent 50%),
                    var(--bg-canvas);
                color: var(--midnight);
                display: flex; align-items: center; justify-content: center;
                min-height: 100vh;
                overflow: hidden;
            }
        }

        /* ç™»éŒ„å®¹å™¨èˆ‡å‹•ç•« */
        .login-container {
            width: 100%; max-width: 420px; padding: 32px;
            text-align: center;
            animation: containerEntrance 1.2s var(--spring-easing);
        }

        @keyframes containerEntrance {
            from { opacity: 0; transform: scale(0.9) translateY(40px); filter: blur(10px); }
            to { opacity: 1; transform: scale(1) translateY(0); filter: blur(0); }
        }

        .brand-logo {
            font-size: 80px; margin-bottom: 24px;
            display: inline-block;
            filter: drop-shadow(0 20px 30px oklch(0% 0 0 / 15%));
            animation: floating 6s ease-in-out infinite;
        }

        @keyframes floating {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .brand-title { 
            font-size: 36px; font-weight: 900; letter-spacing: -1.5px; margin-bottom: 12px;
            background: linear-gradient(135deg, var(--midnight), var(--primary-deep));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }

        .brand-subtitle { 
            color: oklch(55% 0.02 240); font-size: 16px; margin-bottom: 48px; 
            font-weight: 500; opacity: 0.8;
        }

        /* Bento é–€æˆ¶æŒ‰éˆ•ï¼šç»ç’ƒæ“¬æ…‹èˆ‡ç‰©ç†åé¥‹ */
        .portals { display: grid; gap: 18px; }

        .portal-btn {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            border-radius: var(--radius-lg);
            padding: 24px;
            display: flex; align-items: center;
            border: 1.5px solid var(--glass-border);
            box-shadow: 0 12px 30px -10px var(--glass-shadow);
            transition: all 0.5s var(--spring-easing);
            cursor: pointer; position: relative; overflow: hidden;
        }

        .portal-btn::before {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(120deg, transparent, oklch(100% 0 0 / 20%), transparent);
            transform: translateX(-100%); transition: 0.6s;
        }

        .portal-btn:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 20px 40px -12px var(--glass-shadow);
            border-color: oklch(100% 0 0 / 60%);
        }

        .portal-btn:hover::before { transform: translateX(100%); }

        .portal-btn:active { transform: scale(0.96); transition: 0.1s; }

        .portal-btn .icon {
            width: 64px; height: 64px; border-radius: 22px; font-size: 28px;
            display: flex; align-items: center; justify-content: center; margin-right: 20px;
            box-shadow: inset 0 -4px 8px oklch(0% 0 0 / 5%);
        }

        .portal-btn .label-group { flex: 1; text-align: left; }
        .portal-btn .label { font-weight: 800; font-size: 19px; display: block; color: var(--midnight); }
        .portal-btn .subtext { font-size: 13px; color: oklch(50% 0.01 240); font-weight: 500; }
        .portal-btn .arrow { font-size: 24px; color: oklch(0% 0 0 / 15%); transition: 0.3s; }
        .portal-btn:hover .arrow { transform: translateX(5px); color: var(--primary); }

        /* å…¨å±æ¨¡æ…‹æ¡†ï¼š2026 æ²‰æµ¸å¼é«”é©— */
        .modal {
            position: fixed; inset: 0; 
            background: oklch(10% 0.01 240 / 30%);
            backdrop-filter: blur(25px) saturate(180%);
            -webkit-backdrop-filter: blur(25px) saturate(180%);
            display: none; align-items: center; justify-content: center; z-index: 1000;
            padding: 20px;
        }

        .modal.active { display: flex; animation: modalOverlayIn 0.4s ease; }

        .modal-content { 
            background: oklch(100% 0 0 / 85%);
            width: 100%; max-width: 380px; padding: 40px 32px; 
            border-radius: var(--radius-xl);
            box-shadow: 0 40px 100px oklch(0% 0 0 / 20%);
            border: 1px solid oklch(100% 0 0 / 50%);
            transform: scale(1);
        }

        @keyframes modalOverlayIn { from { opacity: 0; } to { opacity: 1; } }
        .modal.active .modal-content { animation: modalContentIn 0.5s var(--spring-easing); }
        @keyframes modalContentIn { from { transform: scale(0.8) translateY(30px); opacity: 0; } }

        /* è¼¸å…¥æ§ä»¶å„ªåŒ– */
        .input-group { margin-bottom: 20px; text-align: left; }
        .input-label { font-size: 13px; font-weight: 700; color: var(--primary-deep); margin-bottom: 8px; display: block; padding-left: 12px; }
        
        .input-premium {
            width: 100%; padding: 18px 20px; border-radius: var(--radius-md);
            background: oklch(96% 0.01 240); border: 2px solid transparent;
            font-size: 16px; font-weight: 600; color: var(--midnight);
            transition: all 0.3s;
        }

        .input-premium:focus {
            outline: none; background: white; border-color: var(--primary);
            box-shadow: 0 10px 20px oklch(60% 0.18 255 / 10%);
        }

        /* å‹•ä½œæŒ‰éˆ• */
        .btn-submit {
            width: 100%; padding: 20px; border-radius: var(--radius-md);
            background: var(--midnight); color: white; border: none;
            font-size: 17px; font-weight: 800; cursor: pointer;
            transition: all 0.3s; margin-top: 10px;
        }
        .btn-submit:active { transform: scale(0.97); background: oklch(10% 0.01 240); }

        /* åå¸æç¤ºï¼šå‹•æ…‹å³¶é¢¨æ ¼ */
        .toast {
            position: fixed; top: 40px; left: 50%; transform: translateX(-50%) translateY(-100px);
            background: var(--midnight); color: white; padding: 14px 28px;
            border-radius: 40px; font-size: 14px; font-weight: 700;
            box-shadow: 0 20px 40px oklch(0% 0 0 / 20%);
            transition: 0.6s cubic-bezier(0.18, 0.89, 0.32, 1.28);
            z-index: 2000; opacity: 0;
        }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }
    </style>
</head>
<body>

    <div class="login-container">
        <div class="brand-logo">ğŸ </div>
        <h1 class="brand-title">SmartClean</h1>
        <p class="brand-subtitle">ä¸‹ä¸€ä»£é«˜æ•ˆçŸ­ç§Ÿèª¿åº¦ç³»çµ±</p>
        
        <div class="portals">
            <div class="portal-btn" onclick="openLogin('host')">
                <span class="icon" style="background: var(--accent-orange); color: white;">ğŸ¡</span>
                <div class="label-group">
                    <span class="label">æˆ¿æ±é–€æˆ¶</span>
                    <span class="subtext">ç®¡ç†ç‰©æ¥­èˆ‡ç™¼å¸ƒéœ€æ±‚</span>
                </div>
                <span class="arrow">â†’</span>
            </div>

            <div class="portal-btn" onclick="openLogin('cleaner')">
                <span class="icon" style="background: var(--accent-blue); color: white;">âœ¨</span>
                <div class="label-group">
                    <span class="label">å¤¥ä¼´æ¥å–®</span>
                    <span class="subtext">æŸ¥çœ‹ä»»å‹™èˆ‡å·¥å–®çµç®—</span>
                </div>
                <span class="arrow">â†’</span>
            </div>

            <div class="portal-btn" onclick="openLogin('admin')">
                <span class="icon" style="background: var(--accent-purple); color: white;">ğŸ“Š</span>
                <div class="label-group">
                    <span class="label">å¾Œå°èª¿åº¦</span>
                    <span class="subtext">å…¨åŸŸç›£æ§èˆ‡è³‡æºåˆ†é…</span>
                </div>
                <span class="arrow">â†’</span>
            </div>
        </div>
    </div>

    <div class="modal" id="loginModal" onclick="if(event.target === this) closeModal()">
        <div class="modal-content">
            <h2 id="modalTitle" style="text-align:center; font-size:24px; font-weight:900; margin-bottom:32px; letter-spacing:-1px;">é©—è­‰èº«ä»½</h2>
            <div id="modalFields"></div>
            <button class="btn-submit" onclick="handleLogin()">é€²å…¥ç³»çµ±</button>
            <button onclick="closeModal()" style="width:100%; margin-top:20px; background:none; border:none; color:oklch(60% 0.02 240); font-weight:700; cursor:pointer;">è¿”å›</button>
        </div>
    </div>

    <div class="toast" id="toast"></div>

    <script>
        const API = 'https://biggish-londyn-unconvolute.ngrok-free.dev/api';
        let currentMode = '';

        // æ¨¡æ“¬ç‰©ç†åé¥‹
        function triggerHaptic(type = 'light') {
            if (!navigator.vibrate) return;
            if (type === 'light') navigator.vibrate(15);
            else if (type === 'error') navigator.vibrate([40, 30, 40]);
        }

        function showToast(msg, isError = false) {
            const t = document.getElementById('toast');
            t.textContent = msg;
            t.style.background = isError ? 'oklch(55% 0.2 25)' : 'var(--midnight)';
            t.classList.add('show');
            triggerHaptic(isError ? 'error' : 'light');
            setTimeout(() => t.classList.remove('show'), 3000);
        }

        function openLogin(mode) {
            currentMode = mode;
            triggerHaptic();
            const titles = { host: 'æˆ¿æ±ç™»éŒ„', cleaner: 'æ¸…æ½”å¤¥ä¼´ç™»éŒ„', admin: 'ç³»çµ±èª¿åº¦å®˜' };
            document.getElementById('modalTitle').textContent = titles[mode];
            
            let fields = `
                <input-group>
                    <label class="input-label">é©—è­‰å¯†é‘°</label>
                    <input type="text" id="mainCode" class="input-premium" placeholder="è«‹è¼¸å…¥ 6 ä½ä»£ç¢¼" spellcheck="false">
                </input-group>
                `;
            
            if (mode === 'admin') {
                fields = `
                    <input-group>
                        <label class="input-label">ç®¡ç†å“¡å¸³è™Ÿ</label>
                        <input type="text" id="adminUser" class="input-premium" value="admin">
                    </input-group>
                    <input-group>
                        <label class="input-label">èªè­‰å¯†ç¢¼</label>
                        <input type="password" id="adminPass" class="input-premium" value="admin123">
                    </input-group>
                    `;
            }
            
            document.getElementById('modalFields').innerHTML = fields;
            document.getElementById('loginModal').classList.add('active');
            
            // æ¸¬è©¦ç’°å¢ƒé å¡«
            if(mode === 'host') setTimeout(() => document.getElementById('mainCode').value = '547047', 100);
            if(mode === 'cleaner') setTimeout(() => document.getElementById('mainCode').value = '733025', 100);
        }

        function closeModal() { 
            document.getElementById('loginModal').classList.remove('active'); 
        }

        async function handleLogin() {
            const btn = document.querySelector('.btn-submit');
            btn.textContent = 'é©—è­‰ä¸­...';
            btn.style.opacity = '0.7';

            try {
                if (currentMode === 'host') {
                    const code = document.getElementById('mainCode').value;
                    const res = await fetch(API + '/hosts/code/' + code);
                    const data = await res.json();
                    if (data.data) {
                        localStorage.setItem('host_id', data.data.id);
                        localStorage.setItem('host_phone', data.data.phone);
                        window.location.href = 'host.html';
                    } else {
                        alert('é©—è­‰ç¢¼éŒ¯èª¤');
                    }
                } 
                else if (currentMode === 'cleaner') {
                    const code = document.getElementById('mainCode').value;
                    const res = await fetch(API + '/cleaners');
                    const data = await res.json();
                    const cleaner = data.data.find(c => c.code == code);
                    if (cleaner) {
                        localStorage.setItem('cleaner_id', cleaner.id);
                        localStorage.setItem('cleaner_code', cleaner.code);
                        localStorage.setItem('cleaner_name', cleaner.name);
                        window.location.href = 'cleaner.html';
                    } else {
                        alert('é©—è­‰ç¢¼éŒ¯èª¤');
                    }
                }
                else if (currentMode === 'admin') {
                    const u = document.getElementById('adminUser').value;
                    const p = document.getElementById('adminPass').value;
                    if (u === 'admin' && p === 'admin123') {
                        localStorage.setItem('admin_user', u);
                        window.location.href = 'admin.html';
                    } else {
                        alert('å¸³è™Ÿå¯†ç¢¼éŒ¯èª¤');
                    }
                }
            } catch (err) {
                showToast(err.message, true);
                btn.textContent = 'é€²å…¥ç³»çµ±';
                btn.style.opacity = '1';
            }
        }
    </script>
</body>
</html>