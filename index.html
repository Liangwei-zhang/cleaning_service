<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ  çŸ­ç§Ÿæ¸…æ½”ç®¡ç†</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #f5f5f5; }
        
        .login-screen { display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 100vh; padding: 20px; background: linear-gradient(135deg, #8A9A5B 0%, #6B7A45 100%); }
        .login-box { background: white; padding: 30px; border-radius: 16px; width: 100%; max-width: 350px; text-align: center; }
        .login-logo { font-size: 60px; margin-bottom: 20px; }
        .login-title { font-size: 24px; margin-bottom: 20px; color: #333; }
        .role-btn { display: block; width: 100%; padding: 15px; margin: 10px 0; border: 2px solid #8A9A5B; border-radius: 10px; background: white; color: #8A9A5B; font-size: 16px; cursor: pointer; }
        .role-btn:hover { background: #8A9A5B; color: white; }
        
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; }
        .modal.active { display: flex; align-items: center; justify-content: center; }
        .modal-content { background: white; padding: 20px; border-radius: 12px; width: 90%; max-width: 350px; }
        .modal-content h3 { margin-bottom: 15px; color: #333; }
        .modal-content input { width: 100%; padding: 12px; margin: 8px 0; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; }
        .modal-content button { width: 100%; padding: 12px; margin: 8px 0; border: none; border-radius: 8px; background: #8A9A5B; color: white; font-size: 14px; cursor: pointer; }
        .modal-content button.cancel { background: #999; }
        
        /* Toast æç¤º */
        .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: #333; color: white; padding: 14px 24px; border-radius: 10px; font-size: 15px; z-index: 2000; opacity: 0; transition: all 0.3s ease; }
        .toast.show { transform: translateX(-50%) translateY(0); opacity: 1; }
        .toast.success { background: #4CAF50; }
        .toast.error { background: #f44336; }
        .toast.warn { background: #ff9800; }
    </style>
</head>
<body>
    <div class="login-screen">
        <div class="login-box">
            <div class="login-logo">ğŸ </div>
            <div class="login-title">çŸ­ç§Ÿæ¸…æ½”ç®¡ç†</div>
            <button class="role-btn" onclick="showHostLogin()">ğŸ  æˆ¿æ±ï¼ˆç™¼å–®ï¼‰</button>
            <button class="role-btn" onclick="showCleanerLogin()">ğŸ‘· æ¸…æ½”å·¥ï¼ˆæ¥å–®ï¼‰</button>
            <button class="role-btn" onclick="showAdminLogin()">ğŸ“Š èª¿åº¦å¹³å°ï¼ˆç®¡ç†ï¼‰</button>
        </div>
    </div>
    
    <!-- æˆ¿æ±ç™»éŒ„ -->
    <div class="modal" id="modal-host">
        <div class="modal-content">
            <h3>ğŸ  æˆ¿æ±ç™»éŒ„</h3>
            <input type="text" id="host-code" placeholder="é©—è­‰ç¢¼" value="547047">
            <button onclick="loginHost()">ç™»éŒ„</button>
            <button class="cancel" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- æ¸…æ½”å·¥ç™»éŒ„ -->
    <div class="modal" id="modal-cleaner">
        <div class="modal-content">
            <h3>ğŸ‘· æ¸…æ½”å·¥ç™»éŒ„</h3>
            <input type="text" id="cleaner-code" placeholder="é©—è­‰ç¢¼" value="733025">
            <button onclick="loginCleaner()">ç™»éŒ„</button>
            <button class="cancel" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
    
    <!-- ç®¡ç†å“¡ç™»éŒ„ -->
    <div class="modal" id="modal-admin">
        <div class="modal-content">
            <h3>ğŸ“Š ç®¡ç†å“¡ç™»éŒ„</h3>
            <input type="text" id="admin-username" placeholder="ç”¨æˆ¶å" value="admin">
            <input type="password" id="admin-password" placeholder="å¯†ç¢¼" value="admin123">
            <button onclick="loginAdmin()">ç™»éŒ„</button>
            <button class="cancel" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
    
    <div class="toast" id="toast"></div>
    
    <script>
        function showToast(msg, type = 'success') {
            const toast = document.getElementById('toast');
            toast.textContent = msg;
            toast.className = 'toast ' + type;
            setTimeout(() => toast.classList.add('show'), 10);
            setTimeout(() => toast.classList.remove('show'), 2500);
        }
        
        const API = 'https://biggish-londyn-unconvolute.ngrok-free.dev/api';
        
        function showHostLogin() { document.getElementById('modal-host').classList.add('active'); }
        function showCleanerLogin() { document.getElementById('modal-cleaner').classList.add('active'); }
        function showAdminLogin() { document.getElementById('modal-admin').classList.add('active'); }
        function closeModal() { 
            document.getElementById('modal-host').classList.remove('active');
            document.getElementById('modal-cleaner').classList.remove('active');
            document.getElementById('modal-admin').classList.remove('active');
        }
        
        async function loginHost() {
            const code = document.getElementById('host-code').value;
            if (!code) { showToast('è«‹è¼¸å…¥é©—è­‰ç¢¼', 'warn'); return; }
            
            const res = await fetch(API + '/hosts/code/' + code);
            const data = await res.json();
            
            if (res.ok && data.data) {
                localStorage.setItem('host_id', data.data.id);
                localStorage.setItem('host_phone', data.data.phone);
                location.href = 'host.html';
            } else {
                showToast('é©—è­‰ç¢¼éŒ¯èª¤', 'error');
            }
        }
        
        async function loginCleaner() {
            const code = document.getElementById('cleaner-code').value;
            if (!code) { showToast('è«‹è¼¸å…¥é©—è­‰ç¢¼', 'warn'); return; }
            
            const res = await fetch(API + '/cleaners');
            const data = await res.json();
            const cleaner = data.data?.find(c => c.code === code);
            
            if (cleaner) {
                localStorage.setItem('cleaner_id', cleaner.id);
                localStorage.setItem('cleaner_code', cleaner.code);
                location.href = 'cleaner.html';
            } else {
                showToast('é©—è­‰ç¢¼éŒ¯èª¤', 'error');
            }
        }
        
        async function loginAdmin() {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            
            if (username === 'admin' && password === 'admin123') {
                localStorage.setItem('admin_user', username);
                location.href = 'admin.html';
            } else {
                showToast('ç”¨æˆ¶åæˆ–å¯†ç¢¼éŒ¯èª¤', 'error');
            }
        }
    </script>
</body>
</html>
